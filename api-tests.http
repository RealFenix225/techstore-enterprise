### ==========================================
### D칈A 3: PRUEBAS DE L칍GICA DE NEGOCIO
### ==========================================

### TEST 3: CREAR PRODUCTO (Happy Path)
POST http://localhost:8080/api/products
Content-Type: application/json

{
  "name": "Lenovo Legion 5 Pro",
  "description": "Gaming laptop with RTX 3070",
  "price": 1400.00,
  "stock": 15,
  "categoryId": 1,
  "providerId": 1
}

### TEST 4: PRUEBA DE SOBREVENTA (Esperamos 409 Conflict)
# Objetivo: Intentar restar m치s stock del que existe.
# El sistema debe detenernos con StockInsufficientException.
PATCH http://localhost:8080/api/products/324/stock?quantity=999999

### TEST 5: VENTA EXITOSA (Esperamos 200 OK)
# Objetivo: Restar una cantidad v치lida.
# El stock debe bajar en 1.
PATCH http://localhost:8080/api/products/324/stock?quantity=1

### TEST 6: VALIDACI칍N DE CANTIDAD (Esperamos 400 Bad Request)
# Objetivo: Verificar que Positive sigue funcionando en el Controller.
PATCH http://localhost:8080/api/products/324/stock?quantity=-5


### TEST DE INTEGRACI칍N: VENTA + TRAZABILIDAD
# 1. Reducimos stock (L칩gica)
# 2. Esperamos un header X-Correlation-Id (Observabilidad)
PATCH http://localhost:8080/api/products/501/stock?quantity=1


###B칰squedas del 01/02
### B칔SQUEDA AVANZADA 1: Por nombre parcial (Deber칤a traer Lenovo)
GET http://localhost:8080/api/products/filter?name=Lenovo

### B칔SQUEDA AVANZADA 2: Filtros combinados (Precio + Categor칤a)
GET http://localhost:8080/api/products/filter?minPrice=100&maxPrice=2000&category=Electronics

### B칔SQUEDA AVANZADA 3: Sin filtros (Trae todo)
GET http://localhost:8080/api/products/filter

### B칔SQUEDA AVANZADA PAGINADA
GET http://localhost:8080/api/products/filter?category=Electronics&page=0&size=2



### TEST ERROR 1: Validaci칩n (Precio negativo)
# Deber칤a devolver 400 Bad Request con detalles del campo "price"
POST http://localhost:8080/api/products
Content-Type: application/json

{
  "name": "Error Product",
  "description": "Testing validation",
  "price": -50.00,
  "stock": 10,
  "categoryId": 1,
  "providerId": 1
}

### TEST ERROR 2: Negocio (Stock Insuficiente)
# Intenta comprar m치s de lo que hay (ej. 1000 unidades del prod 501)
# Deber칤a devolver 409 Conflict y el mensaje de error limpio
PATCH http://localhost:8080/api/products/501/stock?quantity=10000

### TEST para SPRING SECURITY (02/02)
GET http://localhost:8080/api/products

### PRUEBA DE SEGURIDAD: Listar Productos (Debe dar 200 OK) (06/02)
GET http://localhost:8080/api/products
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJnZW5lcmFsQHRlY2hzdG9yZS5jb20iLCJpYXQiOjE3NzA0MDE1NzIsImV4cCI6MTc3MDQ4Nzk3Mn0._rgun91oL5PcSh2e8xIG7xTbUNrDaL_q6587n9GUINU
Content-Type: application/json

###Prueba 06/02
POST http://localhost:8080/api/auth/authenticate

###Nueva petici칩n 06/02
POST http://localhost:8080/api/auth/authenticate
Content-Type: application/json

{
  "email": "general@techstore.com",
  "password": "password123"
}

### =================================================================
### Objetivo: Comprobar que cualquiera puede VER sin token.
### =================================================================
GET http://localhost:8080/api/products
Content-Type: application/json

# 游릭 ESPERADO: 200 OK (Lista de productos)


### =================================================================
### ESCENARIO 2:o Norma RECLUTAMIENTO (Crear Usuaril)
### Objetivo: Crear un soldado raso (USER) para probar que NO tiene poder.
### =================================================================
POST http://localhost:8080/api/auth/register
Content-Type: application/json

{
  "firstname": "Pepe",
  "lastname": "Soldado",
  "email": "pepe@user.com",
  "password": "user123",
  "role": "USER"
}

# 游릭 ESPERADO: 200 OK + Token (Copia este token para el paso 3)


### =================================================================
### 游빍 ESCENARIO 3: EL INTRUSO (Usuario Normal intenta Borrar)
### Objetivo: Intentar borrar un producto siendo solo USER.
### =================================================================
# 丘멆잺 REEMPLAZA EL TOKEN ABAJO CON EL DE PEPE
DELETE http://localhost:8080/api/products/1
Authorization: Bearer PEGA_AQUI_EL_TOKEN_DE_PEPE

# 游댮 ESPERADO: 403 FORBIDDEN (춰Acceso Denegado! El sistema funciona)


### =================================================================
### 游빍 ESCENARIO 4: AUTENTICACI칍N DEL GENERAL (Login Admin)
### Objetivo: Obtener el token del Jefe Supremo.
### =================================================================
POST http://localhost:8080/api/auth/authenticate
Content-Type: application/json

{
  "email": "general@techstore.com",
  "password": "password123"
}

# 游릭 ESPERADO: 200 OK + Token (Copia este token para el paso 5)


### =================================================================
### 游빍 ESCENARIO 5: EL COMANDANTE (Admin Borra Producto)
### Objetivo: Demostrar que el ADMIN s칤 tiene permiso.
### =================================================================
# 丘멆잺 REEMPLAZA EL TOKEN ABAJO CON EL DEL GENERAL
# Aseg칰rate de usar un ID que exista (mira la lista del paso 1)
DELETE http://localhost:8080/api/products/274
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJnZW5lcmFsQHRlY2hzdG9yZS5jb20iLCJpYXQiOjE3NzA0MDE1NzIsImV4cCI6MTc3MDQ4Nzk3Mn0._rgun91oL5PcSh2e8xIG7xTbUNrDaL_q6587n9GUINU

# 游릭 ESPERADO: 204 NO CONTENT (Producto eliminado) o 200 OK
###

POST http://localhost:8080/api/products/import